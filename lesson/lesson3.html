<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>レッスン３</title>
<link type="text/css" href="lesson.css" rel="stylesheet">
<style>
.x, .b {
	height:13px;
	font-size:9px;
}
.x > div,
.b > div {
	padding:0;
	border:1px solid gray;
	width:12px;
	height:12px;
	display: inline-block;
	vertical-align:top;
	text-align:center;
	margin-top: -1px;
	margin-left: -1px;
	white-space:nowrap;
}
.b > div:first-child {
	border-color: white;
}
.x > div {
	border-color: white;
}
</style>
<script type='text/javascript' src="../index/post.js"></script>
<script>
window.onload = function() {
	post_init("lesson3");
}
</script>
</head>
<body>
<h3>レッスン３ 「迷路」(2D)を表示してみよう</h3>

<table>
<tr><td valign=top><img src=maze2.png></td>
<td style="padding-left:10px;">迷路プログラムは、無線の受信・送信を行うスプライト（メイン）と、
迷路を表示するスプライト（マップ）の構成で動かします<br>
マップの座標は、以下の値を使います<br>

<br>
<div class=x><div></div><div>0</div><div>1</div><div>2</div><div>3</div><div>...</div><div>m</div></div>
<div class=b><div>0</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
<div class=b><div>1</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
<div class=b><div>2</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
<div class=b><div>3</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
<div class=b><div>:</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
<div class=b><div>m</div><div></div><div></div><div></div><div></div><div></div><div></div></div>
</td></tr></table>

<h4>迷路プログラムでは拡張機能の「Radio」と「ペン」を使います<br>
拡張機能を追加で「Radio」と「ペン」を組みこんでください</h4>

<h4>まず、スプライト（マップ）を作ります</h4>

<li>メインとマップのスプライト間で使う変数 X、Y、Z を作ります</li>
<li>迷路の大きさの変数 SX、SY、<br>
ゴール位置の変数 GX、GY、<br>
現在位置の変数 CX、CY、CZ も作ります</li>

<li>それから迷路データを入れるリスト MAP を作ります<br>

<div><img src=l3_map.png width=250></div></li>

<li>マップのスプライトのみで使う変数 _X、_Y、_Z、_C を作ります</li>

<li>迷路データ全体を表示するブロック（DRAWを受け取ったとき）、<br>
１行分を表示するブロック(DRAWLINE)、<br>
点を表示するブロック(DRAWPOINT)、<br>
ペン動作のブロック(DRAWPEN)をそれぞれ作ります</li>

<table class=t>
<tr><td><img src=l3_draw.png></td>
<td></td></tr>
<tr><td><img src=l3_drawa.png></td>
<td></td></tr>
<tr><td><img src=l3_drawb.png></td>
<td></td></tr>
<tr><td><img src=l3_drawc.png></td>
<td></td></tr>
</table>

<li>現在の位置を表示するブロック（SHOWを受け取ったとき）、<br>
現在の位置を隠すブロック（HIDEを受け取ったとき）、<br>
指定位置を表示するブロック（POINTを受け取ったとき）も作ります</li>

<table class=t>
<tr><td><img src=l3_draw2.png></td>
<td></td></tr>
<tr><td><img src=l3_draw2a.png></td>
<td></td></tr>
<tr><td><img src=l3_draw2b.png></td>
<td></td></tr>
</table>

<h4>スプライト（メイン）を作ります</h4>

<li>上向き矢印のイメージをコスチュームとして設定します<br>

<div><img src=l3_arrow.png width=400></div></li>

<li>「実行が押されたとき」に利用するバンド、グループを宣言するブロックを配置します<br>

<div><img src=l3_run.png></div></li>

</div>

<li>メインのスプライトのみで使う変数 _V、_V1、_V2 を作ります</li>

<li>「ずっと」の前に"s"を送信し、「ずっと」の中に受信した文字列を処理するブロックを配置します</li>

<table class=t>
<tr><td><img src=l3_loop.png></td>
<td></td></tr>
<tr><td><img src=l3_loop1.png></td>
<td>「M」から始まる場合は、迷路データを設定します</td></tr>
<tr><td><img src=l3_loop2.png></td>
<td>「T」から始まる場合は、指定位置から指定方向のデータを設定します</td></tr>
<tr><td colspan=2><img src=l3_loop21.png></td></tr>
<tr><td><img src=l3_loop22.png></td>
<tr><td></td></tr>
<tr><td><img src=l3_loop3.png></td>
<td>「Y」から始まる場合は、現在位置を変数に設定し、迷路を表示します</td></tr>
<tr><td><img src=l3_loop4.png></td>
<td>「G」から始まる場合は、ゴール位置を変数に設定します</td></tr>
<tr><td><img src=l3_loop5.png></td>
<td>「S」から始まる場合は、迷路の大きさを変数に設定します</td></tr>
</table>

<div style="margin-left:30px;margin-top:10px;">各値の意味は <a href=../maze/docs.html>maze/docs.html</a> を見てください</div>

<div></div>

</div>

<li>他人からの通信を確認してみよう</li>

<div style="margin-left:20px;margin-top:10px;">

<li>Scratchプログラムを実行した状態で、<a href=/maze.html target=docs>maze.html</a> を開きます</li>

<li><span>maze.html上で↑で前進、↓で後退、←で左を向く、→で右を向く操作を行います<br>
Scratchプログラムに最新の迷路の状態（maze.htmlの2D viewと同じ状態）が表示されたらOKです</span><br>

<div><img src=l3_html.png width=330><img src=l3_scratch.png width=250 style="vertical-align:bottom;"></div></li>

</div></div>

<hr>

<h4>迷路の表示って遅いよね、一度にパッと表示させることができます。</h4>

<p>「Y」から始まる場合の処理、「T」から始まる場合の処理の中に「再描画モード」を入れてみましょう。<br>例えば「Y」から始まる場合の処理は以下のようにします。</p>

<div style="margin-left:20px;"><img src=l3_redraw.png></div>

<hr>

<h4>【自由研究】ゲームできるように改造してみよう</h4>

<p><a href=../maze/docs.html>maze/docs.html</a> を見て、Scratchから迷路ゲームができるようにしてみよう</p>

<li>↑↓←→のキー操作ができるようにしよう</li>

</body>
</html>
